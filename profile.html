{% extends "base.html" %}
{% block content %}

<style>
    .profile-header {
        background: linear-gradient(135deg, #4e73df, #1cc88a);
        color: white;
        padding: 30px;
        border-radius: 15px;
        margin-bottom: 30px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    }

    .order-card {
        border-radius: 15px;
        padding: 20px;
        border: 1px solid #ddd;
        background: white;
        transition: 0.2s;
    }

    .order-card:hover {
        transform: scale(1.01);
        box-shadow: 0 2px 15px rgba(0,0,0,0.15);
    }

    .item-img {
        width: 70px;
        height: 70px;
        border-radius: 10px;
        object-fit: cover;
    }

    .order-section-title {
        font-weight: 700;
        color: #4e73df;
        margin-top: 40px;
        margin-bottom: 20px;
    }
</style>

<div class="container mt-4">

    <!-- PROFILE HEADER -->
    <div class="profile-header text-center">
        <h2 class="fw-bold">ğŸ‘¤ {{ user.username }}â€™s Profile</h2>
        <p class="mb-1"><strong>Email:</strong> {{ user.email }}</p>
    </div>

    <!-- ORDER HISTORY SECTION -->
    <h3 class="order-section-title">ğŸ§¾ Your Order History</h3>

    {% if orders %}
        {% for order in orders %}
        <div class="order-card mb-4">

            <div class="d-flex justify-content-between">
                <div>
                    <h5 class="mb-1 fw-bold">Order #{{ order.order_id }}</h5>
                    <p class="text-muted mb-1">ğŸ“… Order Date: {{ order.created_at }}</p>
                    <p class="text-muted mb-1">ğŸšš Delivery Date: {{ order.delivery_date }}</p>
                </div>

                <div>
                    {% if order.status == "Completed" %}
                        <span class="badge bg-success px-3 py-2">Completed</span>
                    {% else %}
                        <span class="badge bg-warning text-dark px-3 py-2">Pending</span>
                    {% endif %}
                </div>
            </div>

            <p class="fw-semibold mt-2">ğŸ’° Total Amount: â‚¹{{ order.total_amount }}</p>

            <hr>

            <h6 class="fw-bold mb-3">ğŸ–¼ï¸ Items in this order:</h6>

            {% for item in order["items"] %}
            <div class="d-flex align-items-center mb-3">

                <!-- IMAGE -->
                <img src="{{ item.image_url }}"
                     onerror="this.src='{{ url_for('static', filename='images/placeholder.png') }}'"
                     class="item-img me-3">

                <div>
                    <strong>{{ item.title }}</strong><br>
                    <span class="text-muted">â‚¹{{ item.unit_price }} Ã— {{ item.quantity }}</span>
                </div>
            </div>
            {% endfor %}

        </div>
        {% endfor %}

    {% else %}
        <p class="text-muted text-center">You have no orders yet.</p>
    {% endif %}

</div>

{% endblock %}
